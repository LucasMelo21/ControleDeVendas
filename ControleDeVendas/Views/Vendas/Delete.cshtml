@model ControleDeVendas.Models.Venda

@{
    ViewData["Title"] = "Excluir Venda";
    decimal total = 0m;
}

<h2>Confirmar exclusão</h2>

<div class="alert alert-warning">
    Tem certeza que deseja <strong>excluir</strong> a venda <strong>#@Model.Id</strong>?
</div>

<div class="card mb-3">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3">Código</dt>
            <dd class="col-sm-9">@Model.Id</dd>

            <dt class="col-sm-3">Data</dt>
            <dd class="col-sm-9">@Model.Data.ToString("dd/MM/yyyy HH:mm")</dd>

            <dt class="col-sm-3">Vendedor</dt>
            <dd class="col-sm-9">@Model?.Vendedor?.Nome ?? "-"</dd>
        </dl>
    </div>
</div>

<h5>Itens</h5>
<table class="table table-sm table-striped align-middle">
    <thead>
        <tr>
            <th>Produto</th>
            <th class="text-end">Preço</th>
            <th class="text-end">Qtd</th>
            <th class="text-end">Subtotal</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model?.VendasProdutos ?? Enumerable.Empty<ControleDeVendas.Models.VendaProduto>())
        {
            var preco = (decimal)item.PrecoUnitario;
            var qtd = item.Quantidade;
            var sub = preco * qtd;
            total += sub;
            <tr>
                <td>@item?.Produto?.Nome</td>
                <td class="text-end">@preco.ToString("C")</td>
                <td class="text-end">@qtd</td>
                <td class="text-end">@sub.ToString("C")</td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <th colspan="3" class="text-end">Total</th>
            <th class="text-end">@total.ToString("C")</th>
        </tr>
    </tfoot>
</table>

<form asp-action="Delete" method="post" class="mt-3">
    <input type="hidden" asp-for="Id" />
    <button type="submit" class="btn btn-danger">Excluir</button>
    <a asp-action="Details" asp-route-id="@Model.Id" class="btn btn-secondary">Cancelar</a>
</form>
