@model ControleDeVendas.Models.Venda

@{
    ViewData["Title"] = "Detalhes da Venda";
    decimal total = 0m;
}

<h2>Detalhes da Venda</h2>

<div class="card mb-3">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3">Código</dt>
            <dd class="col-sm-9">@Model.Id</dd>

            <dt class="col-sm-3">Data</dt>
            <dd class="col-sm-9">@Model.Data.ToString("dd/MM/yyyy HH:mm")</dd>

            <dt class="col-sm-3">Vendedor</dt>
            <dd class="col-sm-9">@Model?.Vendedor?.Nome ?? "-"</dd>
        </dl>
    </div>
</div>

<h5>Itens da Venda</h5>
<table class="table table-striped table-sm align-middle">
    <thead>
        <tr>
            <th style="width:40%">Produto</th>
            <th style="width:15%" class="text-end">Preço</th>
            <th style="width:15%" class="text-end">Qtd</th>
            <th style="width:15%" class="text-end">Subtotal</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model?.VendasProdutos ?? Enumerable.Empty<ControleDeVendas.Models.VendaProduto>())
        {
            var preco = (decimal)item.PrecoUnitario;
            var qtd = item.Quantidade;
            var sub = preco * qtd;
            total += sub;
            <tr>
                <td>@item?.Produto?.Nome</td>
                <td class="text-end">@preco.ToString("C")</td>
                <td class="text-end">@qtd</td>
                <td class="text-end">@sub.ToString("C")</td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <th colspan="3" class="text-end">Total</th>
            <th class="text-end">@total.ToString("C")</th>
        </tr>
    </tfoot>
</table>

<div class="mt-3 d-flex gap-2">
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">Editar</a>
    <a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-danger">Excluir</a>
    <a asp-action="Index" class="btn btn-secondary">Voltar</a>
</div>
